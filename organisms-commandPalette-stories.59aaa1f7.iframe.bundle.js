"use strict";(self.webpackChunk_johackim_design_system=self.webpackChunk_johackim_design_system||[]).push([[293],{"./src/organisms/commandPalette.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>commandPalette_stories});var react=__webpack_require__("./node_modules/react/index.js"),next_link=__webpack_require__("./node_modules/next/link.js"),link_default=__webpack_require__.n(next_link),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const[K,ESC,ENTER,UP,DOWN]=[75,27,13,38,40],commandPalette=({url,onClose,...props})=>{const ref=(0,react.useRef)(),refs=(0,react.useRef)([]),[search,setSearch]=(0,react.useState)(""),[activeEntry,setActiveEntry]=(0,react.useState)(0),[isOpen,setOpen]=(0,react.useState)(!1),[data,setData]=(0,react.useState)(props.data),closeCommandPalette=()=>{onClose(),setData([]),setSearch(""),setOpen(!1)};return(0,react.useEffect)((()=>{setOpen(props.isOpen)}),[props.isOpen]),(0,react.useEffect)((()=>{const handleClickOutside=e=>{ref.current?.contains(e.target)||closeCommandPalette()};return document.addEventListener("click",handleClickOutside,!0),()=>document.removeEventListener("click",handleClickOutside,!0)}),[]),(0,react.useEffect)((()=>{document.querySelector("input[name=search]").addEventListener("keydown",(e=>{e.which!==UP&&e.which!==DOWN||e.preventDefault()}))}),[]),(0,react.useEffect)((()=>{const handleKeys=event=>{event.ctrlKey&&event.keyCode===K&&(event.preventDefault(),setOpen((()=>!isOpen))),event.keyCode===ESC&&(event.preventDefault(),setOpen(!1))};return window.addEventListener("keydown",handleKeys),()=>window.removeEventListener("keydown",handleKeys)}),[isOpen]),(0,react.useEffect)((()=>{const scrollTo=id=>refs.current[id].scrollIntoView(!1),handleUp=event=>{event.keyCode===UP&&activeEntry>0&&(setActiveEntry(activeEntry-1),scrollTo(activeEntry-1))},handleDown=event=>{event.keyCode===DOWN&&activeEntry<data.length-1&&(setActiveEntry(activeEntry+1),scrollTo(activeEntry+1))};return window.addEventListener("keydown",handleUp),window.addEventListener("keydown",handleDown),()=>{window.removeEventListener("keydown",handleUp),window.removeEventListener("keydown",handleDown)}}),[activeEntry,data]),(0,react.useEffect)((()=>{const handleEnter=event=>{if(event.keyCode===ENTER){event.preventDefault();const href=data[activeEntry]?.href;href&&(window.location.href=href),closeCommandPalette()}};return window.addEventListener("keydown",handleEnter),()=>window.removeEventListener("keydown",handleEnter)}),[activeEntry,data]),(0,jsx_runtime.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto p-4 sm:p-6 md:p-20 "+(isOpen?"block":"hidden"),role:"dialog","aria-modal":"true",children:[(0,jsx_runtime.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25 transition-opacity","aria-hidden":"true"}),(0,jsx_runtime.jsxs)("div",{ref,className:"mx-auto max-w-xl transform divide-y divide-gray-100 overflow-hidden rounded-xl bg-white shadow-2xl ring-1 ring-black ring-opacity-5 transition-all",children:[(0,jsx_runtime.jsxs)("div",{className:"relative",children:[(0,jsx_runtime.jsx)("svg",{className:"pointer-events-none absolute top-3.5 left-4 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,jsx_runtime.jsx)("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})}),(0,jsx_runtime.jsx)("input",{type:"text",className:"h-12 w-full border-0 bg-transparent pl-11 pr-4 text-gray-800 placeholder-gray-400 focus:outline-none sm:text-sm focus:ring-0",placeholder:"Rechercher...",onChange:async e=>{const{value}=e.target;setSearch(value),!url||value.length<3||await fetch(url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({search:value})}).then((res=>res.json())).then((({results})=>{setActiveEntry(0),setData(results)}))},ref:input=>input&&input.focus(),value:search,name:"search"})]}),data.length>0&&(0,jsx_runtime.jsx)("ul",{className:"max-h-72 scroll-py-2 overflow-y-auto text-sm text-gray-800",children:data.map((({title,href},index)=>(0,jsx_runtime.jsx)(link_default(),{href,onClick:closeCommandPalette,children:(0,jsx_runtime.jsx)("li",{onMouseMove:()=>setActiveEntry(index),className:"select-none px-4 py-2 "+(activeEntry===index?"bg-gray-600 text-white":""),ref:el=>{refs.current[index]=el},children:title},title)},title)))}),0===data.length&&""!==search&&(0,jsx_runtime.jsx)("p",{className:"p-4 text-sm text-gray-500",children:"No results."})]})]})};commandPalette.displayName="commandPalette",commandPalette.defaultProps={isOpen:!1,handleChange:()=>{},data:[]},commandPalette.__docgenInfo={description:"",methods:[],displayName:"commandPalette",props:{isOpen:{defaultValue:{value:"false",computed:!1},required:!1},handleChange:{defaultValue:{value:"() => {}",computed:!1},required:!1},data:{defaultValue:{value:"[]",computed:!1},required:!1}}};const organisms_commandPalette=commandPalette,commandPalette_stories={title:"Organisms/CommandPalette",component:organisms_commandPalette},Template=args=>(0,jsx_runtime.jsx)(organisms_commandPalette,{...args});Template.displayName="Template";const Default=Template.bind({});Default.args={...organisms_commandPalette.defaultProps,isOpen:!0,data:[{title:"Matrix",href:"/1"},{title:"Back to the futur",href:"/2"},{title:"Lord of the ring",href:"/3"},{title:"Limitless",href:"/4"},{title:"Mr. Robot",href:"/5"}]},Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => <CommandPalette {...args} />",...Default.parameters?.docs?.source}}};const __namedExportsOrder=["Default"]}}]);